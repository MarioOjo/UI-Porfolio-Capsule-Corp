  // Helper for mobile bottom bar icons
  const mobileBottomIcons = [
    { icon: <FaUser className="text-xl" />, to: user ? "/profile" : "/auth", label: user ? "Profile" : "Login" },
    { icon: <FaShoppingCart className="text-xl" />, to: "/cart", label: "Cart" },
    { icon: isDarkMode ? <FaSun className="text-xl" /> : <FaMoon className="text-xl" />, action: toggleDarkMode, label: isDarkMode ? "Light" : "Dark" },
    // Add currency selector as a button (could be a modal or dropdown in future)
    { icon: <span className="font-bold text-base">ZA</span>, to: "#", label: "Currency" },
    // Auth actions
    ...(!user ? [
      { icon: <span className="font-bold text-base">LOGIN</span>, to: "/auth", label: "Login" },
      { icon: <span className="font-bold text-base">REGISTER</span>, to: "/auth?tab=signup", label: "Register" }
    ] : [])
  ];
  // Product categories/items for mobile menu
  const mobileMenuItems = [
    { label: "Home", to: "/" },
    { label: "Products", to: "/products" },
    { label: "Battle Gear", to: "/products?category=Battle%20Gear" },
    { label: "Capsules", to: "/products?category=Capsules" },
    { label: "Training", to: "/products?category=Training" },
    { label: "Track Order", to: "/order-tracking" },
    { label: "Contact", to: "/contact" },
    { label: "Cart", to: "/cart" },
  ];
import { Link, useNavigate } from "react-router-dom";
import { FaCapsules, FaUser, FaShoppingCart, FaSearch, FaHeart, FaSignOutAlt, FaMinus, FaPlus, FaTrash, FaTimes, FaMoon, FaSun, FaBars } from "react-icons/fa";
import { useState, useRef, useEffect } from "react";
import { useAuth } from "../../AuthContext";
import { useCart } from "../../contexts/CartContext";
import { useWishlist } from "../../contexts/WishlistContext";
import { apiFetch } from "../../utils/api";
import Price from "../../components/Price";
import { useCurrency } from '../../contexts/CurrencyContext';

function Navbar() {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [search, setSearch] = useState("");
  const [searchResults, setSearchResults] = useState([]);
  const [showSearchResults, setShowSearchResults] = useState(false);
  const [showCartPreview, setShowCartPreview] = useState(false);
  const [showWishlistPreview, setShowWishlistPreview] = useState(false);
  const [isDarkMode, setIsDarkMode] = useState(() => {
    const saved = localStorage.getItem('capsule-theme');
    return saved ? JSON.parse(saved) : false;
  });
  
  const { user, logout } = useAuth();
  const { cartItems, updateQuantity, removeFromCart, getCartTotal, getCartCount } = useCart();
  const { wishlistItems, removeFromWishlist, getWishlistCount } = useWishlist();
  const navigate = useNavigate();
  
  const searchRef = useRef(null);
  const cartRef = useRef(null);
  const wishlistRef = useRef(null);

  // REMOVED: navbar backup content cleared to avoid accidental commits of large JSX backup.
  // If you need the original backup, restore it from your local machine.