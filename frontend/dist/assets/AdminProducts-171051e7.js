import{c as q,K as M,r as c,o as G,a as t,j as l,O as _,f as O}from"./index-bd65ff26.js";function K(){q(),M();const[V,A]=c.useState([]);c.useState(!0);const[L,x]=c.useState(!1),[R,E]=c.useState(!1),[T,U]=c.useState(null);c.useState("");const{showSuccess:b,showError:F}=G(),I=async e=>{try{const r=new FormData;if(r.append("name",e.name),r.append("description",e.description),r.append("price",String(e.price)),r.append("category",e.category),r.append("stock",String(e.stock)),r.append("power_level",String(e.powerLevel||0)),r.append("in_stock",e.inStock?"1":"0"),r.append("gallery",JSON.stringify(e.imageUrls||[])),e.imageFiles&&e.imageFiles.length)for(const i of e.imageFiles)r.append("images",i);const n=await O("/api/products",{method:"POST",body:r});n!=null&&n.product?(A(i=>[n.product,...i]),b("Product created successfully")):b("Product created")}catch(r){throw F(r.message||"Failed to create product"),console.error("Create product error",r),r}},j=async e=>{try{const r=new FormData;if(r.append("name",e.name),r.append("description",e.description),r.append("price",String(e.price)),r.append("category",e.category),r.append("stock",String(e.stock)),r.append("power_level",String(e.powerLevel||0)),r.append("in_stock",e.inStock?"1":"0"),r.append("gallery",JSON.stringify(e.imageUrls||e.gallery||[])),e.imageFiles&&e.imageFiles.length)for(const i of e.imageFiles)r.append("images",i);const n=await O(`/api/products/${e.id}`,{method:"PUT",body:r});n!=null&&n.product?(A(i=>i.map(g=>g.id===n.product.id?n.product:g)),b("Product updated successfully")):b("Product updated")}catch(r){throw F(r.message||"Failed to update product"),console.error("Update product error",r),r}};return t("div",{className:"min-h-screen bg-gray-50 p-6",children:l("div",{className:"max-w-7xl mx-auto",children:[l("div",{className:"flex justify-between items-center mb-6",children:[t("h1",{className:"text-3xl font-bold text-gray-800 font-saiyan",children:"Admin Products"}),l("button",{onClick:()=>x(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-600",children:[t(_,{})," Add Product"]})]}),L&&t(({onSave:e,onCancel:r})=>{const[n,i]=c.useState({name:"",description:"",price:"",category:"Battle Gear",stock:"",powerLevel:"",inStock:!0}),[g,f]=c.useState([]),[p,u]=c.useState(""),[h,y]=c.useState([]),[d,v]=c.useState({}),N=a=>{a.preventDefault(),a.dataTransfer.files&&a.dataTransfer.files.length&&f(s=>[...s,...Array.from(a.dataTransfer.files)])},w=a=>{a.preventDefault()},k=a=>{a.preventDefault();const s={};n.name.trim()||(s.name="Product name is required."),n.description.trim()||(s.description="Description is required."),(!n.price||isNaN(n.price)||Number(n.price)<=0)&&(s.price="Valid price required."),(!n.stock||isNaN(n.stock)||Number(n.stock)<0)&&(s.stock="Valid stock required."),n.category||(s.category="Category required."),g.length===0&&h.length===0&&(s.images="At least one image is required."),v(s),!(Object.keys(s).length>0)&&e({...n,price:parseFloat(n.price),stock:parseInt(n.stock),powerLevel:parseInt(n.powerLevel)||0,imageFiles:g,imageUrls:h})},o=(a,s)=>{i(C=>({...C,[a]:s}))},m=()=>{p.trim()&&(y(a=>[...a,p.trim()]),u(""))},S=a=>{y(s=>s.filter((C,P)=>P!==a))},D=a=>{f(s=>s.filter((C,P)=>P!==a))};return t("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",onDrop:N,onDragOver:w,children:[t("h3",{className:"text-2xl font-bold text-gray-800 font-saiyan mb-6",children:"ADD NEW PRODUCT"}),l("form",{onSubmit:k,className:"space-y-4",children:[l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"PRODUCT NAME"}),t("input",{type:"text",value:n.name,onChange:a=>o("name",a.target.value),placeholder:"Enter product name",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan"}),d.name&&t("div",{className:"text-red-600 text-xs mt-1",children:d.name})]}),l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"DESCRIPTION"}),t("textarea",{value:n.description,onChange:a=>o("description",a.target.value),placeholder:"Enter product description",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-24 resize-none"}),d.description&&t("div",{className:"text-red-600 text-xs mt-1",children:d.description})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"PRICE ($)"}),t("input",{type:"number",step:"0.01",value:n.price,onChange:a=>o("price",a.target.value),placeholder:"0.00",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan"}),d.price&&t("div",{className:"text-red-600 text-xs mt-1",children:d.price})]}),l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"STOCK"}),t("input",{type:"number",value:n.stock,onChange:a=>o("stock",a.target.value),placeholder:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan"}),d.stock&&t("div",{className:"text-red-600 text-xs mt-1",children:d.stock})]})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"CATEGORY"}),l("select",{value:n.category,onChange:a=>o("category",a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan",children:[t("option",{value:"Battle Gear",children:"Battle Gear"}),t("option",{value:"Training",children:"Training"}),t("option",{value:"Technology",children:"Technology"}),t("option",{value:"Capsules",children:"Capsules"})]}),d.category&&t("div",{className:"text-red-600 text-xs mt-1",children:d.category})]}),l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"POWER LEVEL"}),t("input",{type:"number",value:n.powerLevel,onChange:a=>o("powerLevel",a.target.value),placeholder:"9000",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan"})]})]}),l("div",{className:"flex items-center space-x-3",children:[t("input",{type:"checkbox",id:"inStockAdd",checked:n.inStock,onChange:a=>o("inStock",a.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t("label",{htmlFor:"inStockAdd",className:"text-sm font-saiyan text-gray-700",children:"IN STOCK"})]}),l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"IMAGE (file upload or drag-and-drop) — you can select multiple"}),t("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>f(s=>[...s,...Array.from(a.target.files||[])]),className:"w-full"}),t("p",{className:"text-xs text-gray-500 mt-1",children:'Or paste an image URL below and click "Add to Gallery". You can also drag-and-drop images into this modal.'}),l("div",{className:"flex gap-2 mt-2",children:[t("input",{type:"text",value:p,onChange:a=>u(a.target.value),placeholder:"https://...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"}),t("button",{type:"button",onClick:m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Add to Gallery"})]}),d.images&&t("div",{className:"text-red-600 text-xs mt-1",children:d.images}),g.length>0&&l("div",{className:"mt-3",children:[t("p",{className:"text-sm font-saiyan text-gray-700 mb-2",children:"Uploaded Files:"}),t("div",{className:"flex flex-wrap gap-2",children:g.map((a,s)=>l("div",{className:"relative",children:[t("img",{src:URL.createObjectURL(a),alt:`preview-${s}`,className:"w-20 h-20 object-cover rounded-lg border"}),t("button",{type:"button",onClick:()=>D(s),className:"absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",title:"Remove",children:"×"})]},s))})]}),h.length>0&&l("div",{className:"mt-3",children:[t("p",{className:"text-sm font-saiyan text-gray-700 mb-2",children:"Gallery URLs:"}),t("div",{className:"flex flex-wrap gap-2",children:h.map((a,s)=>l("div",{className:"relative",children:[t("img",{src:a,alt:`gallery-${s}`,className:"w-20 h-20 object-cover rounded-lg border"}),t("button",{type:"button",onClick:()=>S(s),className:"absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",title:"Remove",children:"×"})]},s))})]})]}),l("div",{className:"flex space-x-3 pt-4",children:[t("button",{type:"button",onClick:r,className:"flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-lg font-saiyan font-bold hover:bg-gray-400 transition-colors",children:"CANCEL"}),t("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-orange-400 to-orange-600 text-white py-3 px-4 rounded-lg font-saiyan font-bold hover:scale-105 transition-all",children:"ADD PRODUCT"})]})]})]})})},{onSave:async e=>{try{await I(e),x(!1)}catch{}},onCancel:()=>x(!1)}),R&&T&&t(({product:e,onSave:r,onCancel:n})=>{const[i,g]=c.useState({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",price:(e==null?void 0:e.price)||"",category:(e==null?void 0:e.category)||"Battle Gear",stock:(e==null?void 0:e.stock)||"",powerLevel:(e==null?void 0:e.powerLevel)||(e==null?void 0:e.power_level)||"",inStock:(e==null?void 0:e.inStock)!==void 0?e.inStock:(e==null?void 0:e.in_stock)||!0}),[f,p]=c.useState([]);c.useState("");const[u,h]=c.useState((e==null?void 0:e.gallery)||[]),[y,d]=c.useState({}),v=o=>{o.preventDefault(),o.dataTransfer.files&&o.dataTransfer.files.length&&p(m=>[...m,...Array.from(o.dataTransfer.files)])},N=o=>{o.preventDefault()},w=o=>{o.preventDefault();const m={};i.name.trim()||(m.name="Product name is required."),i.description.trim()||(m.description="Description is required."),(!i.price||isNaN(i.price)||Number(i.price)<=0)&&(m.price="Valid price required."),(!i.stock||isNaN(i.stock)||Number(i.stock)<0)&&(m.stock="Valid stock required."),i.category||(m.category="Category required."),f.length===0&&u.length===0&&(m.images="At least one image is required."),d(m),!(Object.keys(m).length>0)&&r({...e,...i,price:parseFloat(i.price),stock:parseInt(i.stock),powerLevel:parseInt(i.powerLevel)||0,imageFiles:f,imageUrls:u,gallery:u})},k=(o,m)=>{g(S=>({...S,[o]:m}))};return e?t("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",onDrop:v,onDragOver:N,children:[t("h3",{className:"text-2xl font-bold text-gray-800 font-saiyan mb-6",children:"EDIT PRODUCT"}),l("form",{onSubmit:w,className:"space-y-4",children:[l("div",{children:[t("label",{className:"block text-sm font-saiyan text-gray-700 mb-2",children:"PRODUCT NAME"}),t("input",{type:"text",value:i.name,onChange:o=>k("name",o.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-saiyan"}),y.name&&t("div",{className:"text-red-600 text-xs mt-1",children:y.name})]}),l("div",{className:"flex space-x-3 pt-4",children:[t("button",{type:"button",onClick:n,className:"flex-1 bg-gray-300 text-gray-700 py-3 px-4 rounded-lg font-saiyan font-bold hover:bg-gray-400 transition-colors",children:"CANCEL"}),t("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-orange-400 to-orange-600 text-white py-3 px-4 rounded-lg font-saiyan font-bold hover:scale-105 transition-all",children:"UPDATE PRODUCT"})]})]})]})}):null},{product:T,onSave:async e=>{try{await j(e),E(!1),U(null)}catch{}},onCancel:()=>{E(!1),U(null)}})]})})}export{K as default};
