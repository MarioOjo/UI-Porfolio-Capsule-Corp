var oe=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var a=(t,e,s)=>(oe(t,e,"read from private field"),s?s.call(t):e.get(t)),d=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)},f=(t,e,s,r)=>(oe(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s);var g=(t,e,s)=>(oe(t,e,"access private method"),s);import{S as Ue,p as Re,q as E,s as ce,t as Y,v as he,w as ue,x as Ce,y as Qe,z as ie,A as De,B as Ae,C as Ee,D as Le,r as b,E as ke,G as Be,h as He,_ as je,H as ze,a as i,j as v,I as Ge}from"./index-3331d913.js";var S,l,K,y,D,j,L,F,q,z,G,A,k,M,V,B,W,Z,de,$,fe,J,me,X,pe,ee,ge,te,be,se,xe,ne,Fe,_e,Ve=(_e=class extends Ue{constructor(e,s){super();d(this,B);d(this,Z);d(this,$);d(this,J);d(this,X);d(this,ee);d(this,te);d(this,se);d(this,ne);d(this,S,void 0);d(this,l,void 0);d(this,K,void 0);d(this,y,void 0);d(this,D,void 0);d(this,j,void 0);d(this,L,void 0);d(this,F,void 0);d(this,q,void 0);d(this,z,void 0);d(this,G,void 0);d(this,A,void 0);d(this,k,void 0);d(this,M,void 0);d(this,V,new Set);this.options=s,f(this,S,e),f(this,F,null),f(this,L,Re()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(a(this,l).addObserver(this),Ie(a(this,l),this.options)?g(this,B,W).call(this):this.updateResult(),g(this,X,pe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ve(a(this,l),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ve(a(this,l),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,g(this,ee,ge).call(this),g(this,te,be).call(this),a(this,l).removeObserver(this)}setOptions(e){const s=this.options,r=a(this,l);if(this.options=a(this,S).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,a(this,l))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");g(this,se,xe).call(this),a(this,l).setOptions(this.options),s._defaulted&&!ce(this.options,s)&&a(this,S).getQueryCache().notify({type:"observerOptionsUpdated",query:a(this,l),observer:this});const n=this.hasListeners();n&&Oe(a(this,l),r,this.options,s)&&g(this,B,W).call(this),this.updateResult(),n&&(a(this,l)!==r||E(this.options.enabled,a(this,l))!==E(s.enabled,a(this,l))||Y(this.options.staleTime,a(this,l))!==Y(s.staleTime,a(this,l)))&&g(this,Z,de).call(this);const c=g(this,$,fe).call(this);n&&(a(this,l)!==r||E(this.options.enabled,a(this,l))!==E(s.enabled,a(this,l))||c!==a(this,M))&&g(this,J,me).call(this,c)}getOptimisticResult(e){const s=a(this,S).getQueryCache().build(a(this,S),e),r=this.createResult(s,e);return Ye(this,r)&&(f(this,y,r),f(this,j,this.options),f(this,D,a(this,l).state)),r}getCurrentResult(){return a(this,y)}trackResult(e,s){return new Proxy(e,{get:(r,n)=>(this.trackProp(n),s==null||s(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&a(this,L).status==="pending"&&a(this,L).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,n))})}trackProp(e){a(this,V).add(e)}getCurrentQuery(){return a(this,l)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=a(this,S).defaultQueryOptions(e),r=a(this,S).getQueryCache().build(a(this,S),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return g(this,B,W).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),a(this,y)))}createResult(e,s){var Ne;const r=a(this,l),n=this.options,c=a(this,y),h=a(this,D),P=a(this,j),w=e!==r?e.state:a(this,K),{state:U}=e;let u={...U},Q=!1,p;if(s._optimisticResults){const C=this.hasListeners(),ae=!C&&Ie(e,s),H=C&&Oe(e,r,s,n);(ae||H)&&(u={...u,...Ae(U.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:I,errorUpdatedAt:T,status:x}=u;p=u.data;let o=!1;if(s.placeholderData!==void 0&&p===void 0&&x==="pending"){let C;c!=null&&c.isPlaceholderData&&s.placeholderData===(P==null?void 0:P.placeholderData)?(C=c.data,o=!0):C=typeof s.placeholderData=="function"?s.placeholderData((Ne=a(this,G))==null?void 0:Ne.state.data,a(this,G)):s.placeholderData,C!==void 0&&(x="success",p=Ee(c==null?void 0:c.data,C,s),Q=!0)}if(s.select&&p!==void 0&&!o)if(c&&p===(h==null?void 0:h.data)&&s.select===a(this,q))p=a(this,z);else try{f(this,q,s.select),p=s.select(p),p=Ee(c==null?void 0:c.data,p,s),f(this,z,p),f(this,F,null)}catch(C){f(this,F,C)}a(this,F)&&(I=a(this,F),p=a(this,z),T=Date.now(),x="error");const N=u.fetchStatus==="fetching",R=x==="pending",le=x==="error",Se=R&&N,we=p!==void 0,O={status:x,fetchStatus:u.fetchStatus,isPending:R,isSuccess:x==="success",isError:le,isInitialLoading:Se,isLoading:Se,data:p,dataUpdatedAt:u.dataUpdatedAt,error:I,errorUpdatedAt:T,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>w.dataUpdateCount||u.errorUpdateCount>w.errorUpdateCount,isFetching:N,isRefetching:N&&!R,isLoadingError:le&&!we,isPaused:u.fetchStatus==="paused",isPlaceholderData:Q,isRefetchError:le&&we,isStale:ye(e,s),refetch:this.refetch,promise:a(this,L),isEnabled:E(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const C=re=>{O.status==="error"?re.reject(O.error):O.data!==void 0&&re.resolve(O.data)},ae=()=>{const re=f(this,L,O.promise=Re());C(re)},H=a(this,L);switch(H.status){case"pending":e.queryHash===r.queryHash&&C(H);break;case"fulfilled":(O.status==="error"||O.data!==H.value)&&ae();break;case"rejected":(O.status!=="error"||O.error!==H.reason)&&ae();break}}return O}updateResult(){const e=a(this,y),s=this.createResult(a(this,l),this.options);if(f(this,D,a(this,l).state),f(this,j,this.options),a(this,D).data!==void 0&&f(this,G,a(this,l)),ce(s,e))return;f(this,y,s);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,c=typeof n=="function"?n():n;if(c==="all"||!c&&!a(this,V).size)return!0;const h=new Set(c??a(this,V));return this.options.throwOnError&&h.add("error"),Object.keys(a(this,y)).some(P=>{const m=P;return a(this,y)[m]!==e[m]&&h.has(m)})};g(this,ne,Fe).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&g(this,X,pe).call(this)}},S=new WeakMap,l=new WeakMap,K=new WeakMap,y=new WeakMap,D=new WeakMap,j=new WeakMap,L=new WeakMap,F=new WeakMap,q=new WeakMap,z=new WeakMap,G=new WeakMap,A=new WeakMap,k=new WeakMap,M=new WeakMap,V=new WeakMap,B=new WeakSet,W=function(e){g(this,se,xe).call(this);let s=a(this,l).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(he)),s},Z=new WeakSet,de=function(){g(this,ee,ge).call(this);const e=Y(this.options.staleTime,a(this,l));if(ue||a(this,y).isStale||!Ce(e))return;const r=Qe(a(this,y).dataUpdatedAt,e)+1;f(this,A,ie.setTimeout(()=>{a(this,y).isStale||this.updateResult()},r))},$=new WeakSet,fe=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(a(this,l)):this.options.refetchInterval)??!1},J=new WeakSet,me=function(e){g(this,te,be).call(this),f(this,M,e),!(ue||E(this.options.enabled,a(this,l))===!1||!Ce(a(this,M))||a(this,M)===0)&&f(this,k,ie.setInterval(()=>{(this.options.refetchIntervalInBackground||De.isFocused())&&g(this,B,W).call(this)},a(this,M)))},X=new WeakSet,pe=function(){g(this,Z,de).call(this),g(this,J,me).call(this,g(this,$,fe).call(this))},ee=new WeakSet,ge=function(){a(this,A)&&(ie.clearTimeout(a(this,A)),f(this,A,void 0))},te=new WeakSet,be=function(){a(this,k)&&(ie.clearInterval(a(this,k)),f(this,k,void 0))},se=new WeakSet,xe=function(){const e=a(this,S).getQueryCache().build(a(this,S),this.options);if(e===a(this,l))return;const s=a(this,l);f(this,l,e),f(this,K,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},ne=new WeakSet,Fe=function(e){Le.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(a(this,y))}),a(this,S).getQueryCache().notify({query:a(this,l),type:"observerResultsUpdated"})})},_e);function We(t,e){return E(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Ie(t,e){return We(t,e)||t.state.data!==void 0&&ve(t,e,e.refetchOnMount)}function ve(t,e,s){if(E(e.enabled,t)!==!1&&Y(e.staleTime,t)!=="static"){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&ye(t,e)}return!1}function Oe(t,e,s,r){return(t!==e||E(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&ye(t,s)}function ye(t,e){return E(e.enabled,t)!==!1&&t.isStaleByTime(Y(e.staleTime,t))}function Ye(t,e){return!ce(t.getCurrentResult(),e)}var Me=b.createContext(!1),Ke=()=>b.useContext(Me);Me.Provider;function qe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Ze=b.createContext(qe()),$e=()=>b.useContext(Ze),Je=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Xe=t=>{b.useEffect(()=>{t.clearReset()},[t])},et=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:n})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(n&&t.data===void 0||ke(s,[t.error,r])),tt=t=>{if(t.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},st=(t,e)=>t.isLoading&&t.isFetching&&!e,at=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Pe=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function rt(t,e,s){var u,Q,p,I,T;const r=Ke(),n=$e(),c=Be(s),h=c.defaultQueryOptions(t);(Q=(u=c.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||Q.call(u,h),h._optimisticResults=r?"isRestoring":"optimistic",tt(h),Je(h,n),Xe(n);const P=!c.getQueryCache().get(h.queryHash),[m]=b.useState(()=>new e(c,h)),w=m.getOptimisticResult(h),U=!r&&t.subscribed!==!1;if(b.useSyncExternalStore(b.useCallback(x=>{const o=U?m.subscribe(Le.batchCalls(x)):he;return m.updateResult(),o},[m,U]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),b.useEffect(()=>{m.setOptions(h)},[h,m]),at(h,w))throw Pe(h,m,n);if(et({result:w,errorResetBoundary:n,throwOnError:h.throwOnError,query:c.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw w.error;if((I=(p=c.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||I.call(p,h,w),h.experimental_prefetchInRender&&!ue&&st(w,r)){const x=P?Pe(h,m,n):(T=c.getQueryCache().get(h.queryHash))==null?void 0:T.promise;x==null||x.catch(he).finally(()=>{m.updateResult()})}return h.notifyOnChangeProps?w:m.trackResult(w)}function it(t,e){return rt(t,Ve,e)}const _={all:["products"],lists:()=>[..._.all,"list"],list:(t={})=>[..._.lists(),{filters:t}],details:()=>[..._.all,"detail"],detail:t=>[..._.details(),t],slug:t=>[..._.all,"slug",t],featured:()=>[..._.all,"featured"],category:t=>[..._.all,"category",t],search:t=>[..._.all,"search",t]};async function nt(t={}){const e=new URLSearchParams;t.featured&&e.append("featured","true"),t.category&&e.append("category",t.category),t.search&&e.append("search",t.search),t.limit&&e.append("limit",String(t.limit));const s=e.toString(),r=`/api/products${s?`?${s}`:""}`,n=await He(r);return(n==null?void 0:n.products)||[]}function lt(t={},e={}){return it({queryKey:_.list(t),queryFn:()=>nt(t),keepPreviousData:!0,...e})}const Te=b.lazy(()=>je(()=>import("./ProductCard-36d9bfdb.js").then(t=>t.a),["assets/ProductCard-36d9bfdb.js","assets/index-3331d913.js","assets/index-8331180c.css","assets/Price-77cf65dd.js"]));function ut(){const[t]=ze(),[e,s]=b.useState(t.get("search")||""),[r,n]=b.useState("all"),[c,h]=b.useState("featured");b.useState(!1);const P=b.useMemo(()=>{const o={};return e.trim()&&(o.search=e.trim()),r!=="all"&&(o.category=r),o},[e,r]),{data:m=[],isLoading:w,isError:U,error:u}=lt(P),Q=[{value:"all",label:"All Categories"},{value:"Battle Gear",label:"âš”ï¸ Battle Gear"},{value:"Training",label:"ðŸ’ª Training"},{value:"Tech",label:"ðŸ“¡ Tech"},{value:"Capsules",label:"ðŸ  Capsules"},{value:"Consumables",label:"ðŸƒ Consumables"}],p=[{value:"featured",label:"Featured First"},{value:"price-low",label:"Price: Low to High"},{value:"price-high",label:"Price: High to Low"},{value:"power-high",label:"Power Level: High to Low"},{value:"power-low",label:"Power Level: Low to High"},{value:"name",label:"Name A-Z"}],I=b.useMemo(()=>!m||m.length===0?[]:[...m].sort((N,R)=>{switch(c){case"price-low":return parseFloat(N.price)-parseFloat(R.price);case"price-high":return parseFloat(R.price)-parseFloat(N.price);case"power-high":return(R.power_level||0)-(N.power_level||0);case"power-low":return(N.power_level||0)-(R.power_level||0);case"name":return N.name.localeCompare(R.name);case"featured":default:return N.featured&&!R.featured?-1:!N.featured&&R.featured?1:(R.power_level||0)-(N.power_level||0)}}),[m,c]),T=I.filter(o=>o.featured),x=I.filter(o=>!o.featured);return w?i("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50",children:i("div",{className:"max-w-7xl mx-auto px-4 py-8",children:v("div",{className:"text-center py-16",children:[i("div",{className:"text-6xl mb-4 animate-pulse",children:"âš¡"}),i("h3",{className:"text-2xl font-bold text-gray-800 mb-4 font-saiyan",children:"LOADING CAPSULES..."}),i("p",{className:"text-gray-600",children:"Gathering legendary gear from the vault..."})]})})}):U?i("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50",children:i("div",{className:"max-w-7xl mx-auto px-4 py-8",children:v("div",{className:"text-center py-16",children:[i("div",{className:"text-6xl mb-4",children:"âš ï¸"}),i("h3",{className:"text-2xl font-bold text-gray-800 mb-4 font-saiyan",children:"CONNECTION ERROR"}),i("p",{className:"text-gray-600 mb-6",children:(u==null?void 0:u.message)||"Failed to load products. Please try again."}),i("button",{onClick:()=>window.location.reload(),className:"bg-gradient-to-r from-orange-400 to-orange-600 text-white px-8 py-3 rounded-xl font-saiyan font-bold kamehameha-glow transition-all hover:scale-105",children:"RETRY"})]})})}):i("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50",children:v("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:py-8",children:[v("div",{className:"mb-6 sm:mb-8",children:[i("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-800 mb-4 font-saiyan",children:"CAPSULE CORP INVENTORY"}),i("p",{className:"text-gray-600 text-sm sm:text-base lg:text-lg",children:"Power up with authentic Z-Fighter equipment and legendary gear"})]}),v("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8",children:[v("div",{className:"flex flex-col gap-4",children:[v("div",{className:"relative w-full",children:[i(Ge,{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 text-gray-400"}),i("input",{type:"text",placeholder:"Search Dragon Balls, Gear...",value:e,onChange:o=>s(o.target.value),className:"w-full pl-10 sm:pl-12 pr-4 py-2 sm:py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-600 focus:ring-2 focus:ring-blue-600/20 transition-all text-sm sm:text-base"})]}),v("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[i("select",{value:r,onChange:o=>n(o.target.value),className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-600 focus:ring-2 focus:ring-blue-600/20 text-sm sm:text-base touch-target",children:Q.map(o=>i("option",{value:o.value,children:o.label},o.value))}),i("select",{value:c,onChange:o=>h(o.target.value),className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-600 focus:ring-2 focus:ring-blue-600/20 text-sm sm:text-base touch-target",children:p.map(o=>i("option",{value:o.value,children:o.label},o.value))})]})]}),i("div",{className:"mt-4 pt-4 border-t border-gray-200",children:v("p",{className:"text-gray-600 text-sm sm:text-base",children:[i("span",{className:"font-bold text-orange-600",children:I.length})," products",e&&v("span",{className:"hidden sm:inline",children:[' for "',i("span",{className:"font-medium",children:e}),'"']}),r!=="all"&&v("span",{className:"hidden sm:inline",children:[" in ",i("span",{className:"font-medium",children:r})]})]})})]}),T.length>0&&v("section",{className:"mb-8 sm:mb-12",children:[v("div",{className:"bg-gradient-to-r from-orange-400 to-orange-600 text-white text-center py-4 sm:py-6 mb-6 sm:mb-8 rounded-2xl shadow-lg kamehameha-glow",children:[i("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold font-saiyan tracking-wide",children:"â­ LEGENDARY ITEMS â­"}),i("p",{className:"mt-2 opacity-90 text-sm sm:text-base",children:"Ultra-rare gear for elite warriors"})]}),i("div",{className:"mobile-grid",children:i(b.Suspense,{fallback:i("div",{className:"text-center py-8",children:"Loading products..."}),children:T.map(o=>i(Te,{product:o,size:"large"},o.id))})})]}),x.length>0&&v("section",{className:"mb-8 sm:mb-12",children:[T.length>0&&i("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-6 sm:mb-8 font-saiyan",children:"ALL CAPSULES"}),i("div",{className:"mobile-grid",children:i(b.Suspense,{fallback:i("div",{className:"text-center py-8",children:"Loading products..."}),children:x.map(o=>i(Te,{product:o,size:"medium"},o.id))})})]}),I.length===0&&v("div",{className:"text-center py-16",children:[i("div",{className:"text-6xl mb-4",children:"ðŸ”"}),i("h3",{className:"text-2xl font-bold text-gray-800 mb-4 font-saiyan",children:"NO CAPSULES FOUND"}),i("p",{className:"text-gray-600 mb-6",children:"We couldn't find any products matching your search criteria."}),i("button",{onClick:()=>{s(""),n("all"),h("featured")},className:"bg-gradient-to-r from-orange-400 to-orange-600 text-white px-8 py-3 rounded-xl font-saiyan font-bold kamehameha-glow transition-all hover:scale-105",children:"RESET FILTERS"})]}),v("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-2xl p-6 sm:p-8 text-center shadow-xl",children:[i("div",{className:"text-3xl sm:text-4xl mb-4",children:"ðŸ’¡"}),i("h3",{className:"text-xl sm:text-2xl font-bold mb-4 font-saiyan",children:"SAIYAN BATTLE TIP"}),i("p",{className:"text-sm sm:text-base lg:text-lg opacity-90",children:"Combine multiple items for devastating power combos! Mix training gear with battle equipment for maximum effectiveness."})]})]})})}export{ut as default};
